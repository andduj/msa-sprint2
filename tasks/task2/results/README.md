# Task 2: Реализация новых сервисов

## Стратегия миграции данных

### Текущее состояние (AS-IS)
- Монолит содержит всю логику бронирования
- Все данные хранятся в одной базе данных PostgreSQL
- Создание бронирования происходит полностью в монолите

### Целевое состояние (TO-BE)
- Booking Service выделен как отдельный микросервис
- Booking History Service для аналитики
- Асинхронная коммуникация через Kafka
- Разделение баз данных по сервисам

### Стратегия миграции

#### 1. Постепенное перенаправление трафика
- **Создание бронирования**: монолит → gRPC → booking-service
- **Получение списка**: пока остается в монолите (будет перенесено позже)
- **Валидация**: остается в монолите (пользователи, отели, промокоды)

#### 2. Разделение ответственности
- **Booking Service**: создание бронирований, расчет цен
- **Monolith**: валидация бизнес-правил, управление пользователями/отелями
- **Booking History Service**: аналитика и исторические данные

#### 3. Асинхронная обработка
- События о создании бронирования отправляются в Kafka
- Booking History Service обрабатывает события асинхронно
- Нет нагрузки на основную базу данных для аналитики

### Архитектурные решения

#### gRPC для синхронной коммуникации
- Высокая производительность
- Строгая типизация через proto файлы
- Поддержка потоковой передачи данных

#### Kafka для асинхронной коммуникации
- Надежная доставка сообщений
- Возможность повторной обработки
- Масштабируемость потребителей

#### Разделение баз данных
- **Monolith DB**: пользователи, отели, промокоды, отзывы
- **Booking DB**: бронирования
- **History DB**: аналитические данные

### Преимущества новой архитектуры

1. **Масштабируемость**: можно масштабировать booking-service независимо
2. **Отказоустойчивость**: отказ одного сервиса не влияет на другие
3. **Независимость разработки**: команды могут работать параллельно
4. **Аналитика**: отдельный сервис для аналитических запросов
5. **Производительность**: оптимизация под конкретные задачи

### Следующие шаги

1. Перенос логики получения списка бронирований в booking-service
2. Создание API Gateway для единой точки входа
3. Внедрение Circuit Breaker для отказоустойчивости
4. Добавление мониторинга и логирования
5. Миграция остальных сервисов (User, Hotel, Review, Promo) 